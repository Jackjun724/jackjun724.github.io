<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0"><meta name="description" content="慕课网视频直链解析 [ Stay Hungry, Stay Foolish ] "><meta name="theme-color" content="#ebc65a"><title>慕课网视频直链解析 [ Stay Hungry, Stay Foolish ] </title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><script src="https://cdn.bootcss.com/highlight.js/9.6.0/highlight.min.js" defer></script><script src="/js/paper.js" defer></script><script src="https://www.googletagmanager.com/gtag/js?id=UA-173003606-1" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-173003606-1');</script><script src="https://www.unpkg.com/valine/dist/Valine.min.js" defer></script><script>window.addEventListener('DOMContentLoaded', () => {
  new Valine({
    el: '#comments',
    appId: 'GyF9w7cCtdicxaKfHKJyjjC9-gzGzoHsz',
    appKey: 'mquBGDELW6u70BiizXk1HGnH',
    notify: true,
    verify: true,
    avatar: 'mp',
    placeholder: '文明发言是交流的起点',
  })
})</script><link rel="stylesheet" href="/css/tocbot.css"><script src="/js/tocbot.js" defer></script><script>window.addEventListener('DOMContentLoaded', () => {
  tocbot.init({
    // Where to render the table of contents.
    tocSelector: '.toc__content',
    // Where to grab the headings to build the table of contents.
    contentSelector: '.article__content',
    // Which headings to grab inside of the contentSelector element.
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    // For headings inside relative or absolute positioned containers within content.
    hasInnerContainers: true,
    orderedList: false,
    collapseDepth: 2,
  });
})</script><link rel="preload" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css"><link rel="preload" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap"><meta name="generator" content="Hexo 4.2.1"></head><body><div class="mask-border"></div><div class="head"><div class="head__inner"><h1><a href="/">Stay Hungry, Stay Foolish</a></h1><p>Development blog</p></div></div><div class="paper-container"><div class="main"><div class="location-bar"><div class="line-1"><div class="horizontal-line" style="height: 3px"></div></div><div class="line-2"><div class="horizontal-line" style="height: 1px"></div></div><p class="text">慕课网视频直链解析</p><div class="switch-button"><input class="container_toggle" type="checkbox" id="switch" name="mode"><label for="switch">Toggle</label></div><div class="line-3"><div class="horizontal-line" style="height: 1px"></div></div></div><div class="main__2-col"><article class="post-view__article"><div class="article__infomation"><div class="posts-item"><h2 class="posts-item__title"><a href="">慕课网视频直链解析</a></h2><span class="post__date">2020-10-20</span><a href="/tags/%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/"><span class="post__tags">#逆向分析</span></a></div></div><div class="article__content"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前学Flutter的时候买了慕课网的课程，因为在线看视频非常不方便，想下载下来，结果发现IMOOC并不支持这个功能，于是就去搜油猴和Gayhub，基本都被和谐了，无果，开始逆向分析。</p>
<h1 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h1><p>直接F12 -&gt; Network，直接网络请求，发现了一个可疑链接：<code>https://www.imooc.com/course/playlist/1430?t=m3u8&amp;_id=5848c001b3fee30a6c8b51bd&amp;cdn=aliyun1</code><br>，在页面HTML的代码中可以直接找到id的存在，那么我们只要收集到这些ID即可，那么在课程的目录页抓ID就可以了，网络的响应数据</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">&#123;<br>    <span class="hljs-string">"result"</span>:<span class="hljs-number">1</span>,<br>    <span class="hljs-string">"data"</span>:&#123;<br>        <span class="hljs-string">"info"</span>:<span class="hljs-string">"MkkqXqhmamoxAUB1PQ..."</span>,<br>        <span class="hljs-string">"cdn"</span>:[<span class="hljs-string">"aliyun"</span>,<span class="hljs-string">"aliyun1"</span>,<span class="hljs-string">"letv"</span>]<br>    &#125;,<br>    <span class="hljs-string">"msg"</span>:<span class="hljs-string">""</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>第一反应<code>info</code>应该是一个算法的密钥或者是加密数据，那我们就继续用F12的Network直接跟到代码里看请求发出的位置，去找到这个加密算法，打下断点，跟着断点往外走，可以发现一段访问了<code>data.info</code>数据的代码<code>destm_1.default(mediadata.data.info);</code><br>这函数中就是所谓的加密算法，解密后我们会得到m3u8文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><code class="hljs m3u8">#EXTM3U<br>#EXT-X-VERSION:3<br>#EXT-X-STREAM-INF:PROGRAM-ID&#x3D;1, BANDWIDTH&#x3D;512000, RESOLUTION&#x3D;1280x720<br>https:&#x2F;&#x2F;www.imooc.com&#x2F;video&#x2F;5848c001b3fee30a6c8b51bd&#x2F;medium.m3u8?cdn&#x3D;aliyun1...<br>#EXT-X-STREAM-INF:PROGRAM-ID&#x3D;1, BANDWIDTH&#x3D;384000, RESOLUTION&#x3D;1280x720<br>https:&#x2F;&#x2F;www.imooc.com&#x2F;video&#x2F;5848c001b3fee30a6c8b51bd&#x2F;medium.m3u8?cdn&#x3D;aliyun1...<br>#EXT-X-STREAM-INF:PROGRAM-ID&#x3D;1, BANDWIDTH&#x3D;256000, RESOLUTION&#x3D;720x480<br>https:&#x2F;&#x2F;www.imooc.com&#x2F;video&#x2F;5848c001b3fee30a6c8b51bd&#x2F;low.m3u8?cdn&#x3D;aliyun1...<br></code></pre></td></tr></table></figure>
<p>打开这些地址后同样的又是相同的返回</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">&#123;<br>    <span class="hljs-string">"code"</span>:<span class="hljs-number">200</span>,<br>    <span class="hljs-string">"data"</span>:&#123;<br>        <span class="hljs-string">"info"</span>:<span class="hljs-string">"Gm1kQ7hmVBYXVGoxVGdUVGA9VBwcKnAyF1RmJD1UY1QHVGRrVBxu..."</span><br>    &#125;,<br>    <span class="hljs-string">"msg"</span>:<span class="hljs-string">"OK"</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>我们用同样的函数去解密，然后就会得到真实的M3U8文件列表。但是文件头写着AES加密，并给出了密钥。</p>
<p>具体解析实现参考我的<a href="https://github.com/Jackjun724/imooc_crack" target="_blank" rel="noopener">Github</a>，原文分析参考<a href="https://halo.cyblogs.top/archives/decrypt-imooc-video-download.html" target="_blank" rel="noopener">这里</a></p>
</div></article><div class="post-view__sidebar"><div class="sidebar"><div class="tocbot"><h2>Toc</h2><div class="toc__content"></div></div><h2>Links</h2><div class="sidebar__link"><ul><li><a href="https://github.com/jackjun724" target="_blank" rel="noopener">Github</a></li><li><a href="https://www.zhihu.com/people/wang-jun-jie-20-30" target="_blank" rel="noopener">知乎</a></li><li><a href="mailto:jackjun0724@gmail.com">Mail</a></li><li><a href="/about/me">AboutMe</a></li></ul></div><h2>Archives</h2><div class="sidebar__archives"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2030/">2030</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a></li></ul></div><h2>Tags</h2><div class="sidebar__tags"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Concurrent/" rel="tag">Concurrent</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Machine-Learning/" rel="tag">Machine Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Performance/" rel="tag">Performance</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag">机器学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/" rel="tag">逆向分析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/" rel="tag">逆向工程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95%E5%AE%9D%E5%85%B8/" rel="tag">面试宝典</a></li></ul></div></div></div></div><div class="horizontal-line" style="height: 1px"></div><div class="main__bottom"><div class="pre-next"><a class="pre-button" href="/2020/11/02/java-concurrent/">Java并发编程</a><a class="next-button" href="/2020/08/19/mysql-performance/">MySQL性能调优</a></div><div id="comments"></div></div></div></div><div class="footer"><span>©️2019-2021 Designed By&nbsp;<strong><a href="https://github.com/random-yang" target="_blank" rel="noopener">RandomYang</a></strong> Powered By&nbsp;</span><strong><a href="https://hexo.io" target="_blank" rel="noopener">hexo</a></strong></div><div class="darkmode-mask" id="darkmode-mask"></div><div class="sidebar__button"></div></body></html>